<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistem Absen QR</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>  <!-- GOOGLE FONT -->  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">  <style>
    * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg,#667eea,#764ba2);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px;
    }
    .container {
      width: 100%;
      max-width: 420px;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 15px 35px rgba(0,0,0,.2);
      overflow: hidden;
      animation: fade .6s ease;
    }
    .header {
      background: linear-gradient(135deg,#667eea,#764ba2);
      color: #fff;
      text-align: center;
      padding: 20px;
    }
    .header h1 { font-size: 20px; margin: 0; }
    .header p { font-size: 13px; opacity: .9; margin-top: 5px; }
    .content { padding: 20px; }
    input, button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ddd;
      margin-bottom: 12px;
      font-size: 14px;
    }
    button {
      background: #667eea;
      color: white;
      font-weight: 600;
      border: none;
      cursor: pointer;
    }
    button.secondary { background: #22c55e; }
    button.logout { background: #ef4444; margin-top: 10px; }
    button.dashboard { background: #3b82f6; margin-top: 10px; }
    #reader {
      display: none;
      border-radius: 12px;
      overflow: hidden;
      border: 2px dashed #667eea;
      margin-bottom: 10px;
    }
    .result {
      display: none;
      padding: 12px;
      border-radius: 10px;
      font-size: 14px;
      margin-top: 10px;
    }
    iframe { width: 100%; height: 380px; border: none; border-radius: 12px; }
    @keyframes fade { from {opacity:0; transform: translateY(15px);} to {opacity:1;} }
  </style></head>
<body><!-- LOGIN --><div class="container" id="loginPage">
  <div class="header">
    <h1>Login Guru</h1>
    <p>Sistem Absen QR</p>
  </div>
  <div class="content">
    <input id="username" placeholder="Username Guru">
    <input id="password" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <div class="result" id="loginError" style="background:#fee2e2;color:#991b1b"></div>
  </div>
</div><!-- ABSEN --><div class="container" id="absenPage" style="display:none">
  <div class="header">
    <h1>Absen QR</h1>
    <p>Isi data lalu scan</p>
  </div>
  <div class="content">
    <input id="nama" placeholder="Nama Siswa">
    <input id="kelas" placeholder="Kelas">
    <button class="secondary" onclick="mulaiScan()">Mulai Scan</button>
    <div id="reader"></div>
    <div class="result" id="hasil"></div>
    <button class="dashboard" onclick="keDashboard()">Dashboard</button>
    <button class="logout" onclick="logout()">Logout</button>
  </div>
</div><!-- DASHBOARD --><div class="container" id="dashboardPage" style="display:none">
  <div class="header">
    <h1>Dashboard Guru</h1>
    <p>Rekap Kehadiran</p>
  </div>
  <div class="content">
    <iframe src="DASHBOARD_SHEETS_URL"></iframe>
    <button onclick="kembaliAbsen()">Kembali</button>
  </div>
</div><script>
  const USER = 'guru', PASS = '12345';
  let sudahAbsen = [];
  let scanner;

  function login() {
    if(username.value === USER && password.value === PASS) {
      loginPage.style.display='none';
      absenPage.style.display='block';
    } else {
      loginError.style.display='block';
      loginError.innerText='Username atau password salah';
    }
  }

  function logout(){ location.reload(); }

  function mulaiScan(){
    if(!nama.value || !kelas.value) return alert('Nama dan kelas wajib diisi');
    reader.style.display='block';
    scanner = new Html5QrcodeScanner('reader',{fps:10,qrbox:250},false);
    scanner.render(onScan);
  }

  function onScan(text){
    hasil.style.display='block';
    if(sudahAbsen.includes(text)){
      hasil.style.background='#fee2e2';
      hasil.style.color='#991b1b';
      hasil.innerHTML='❌ Sudah absen';
      return;
    }
    sudahAbsen.push(text);
    hasil.style.background='#e6fffa';
    hasil.style.color='#065f46';
    hasil.innerHTML=`✅ Berhasil<br>${nama.value} - ${kelas.value}`;
    scanner.clear();
  }

  function keDashboard(){ absenPage.style.display='none'; dashboardPage.style.display='block'; }
  function kembaliAbsen(){ dashboardPage.style.display='none'; absenPage.style.display='block'; }
</script></body>
</html>